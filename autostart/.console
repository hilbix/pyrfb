#!/bin/bash
#
# This Works is placed under the terms of the Copyright Less License,
# see file COPYRIGHT.CLL.  USE AT OWN RISK, ABSOLUTELY NO WARRANTY.

cd "$(dirname "$(readlink -e "$0")")/.." || exit
ID="`basename -- "$0" .sh`" || exit
ID="${ID##*[^0-9]}"
ID="${1:-$ID}"

t=1
while	! read -t$t t
do
	t=1
	unbuffered -cduva "sub/$ID/web/console.txt" ./sendsock.py "$ID" 'do console' || t=20
	mv -f "sub/$ID/web/console.last" "sub/$ID/web/console.old"
	mv -f "sub/$ID/web/console.txt" "sub/$ID/web/console.last"
done

